<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Formulaire de Réservation</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">
  <div class="container mt-5">
    <h1 class="mb-4">Formulaire de Réservation</h1>
    <form id="reservationForm">
      <div class="mb-3">
        <label for="nom_client" class="form-label">Nom du client</label>
        <input type="text" class="form-control" id="nom_client" name="nom_client" required>
      </div>
      <div class="mb-3">
        <label for="prenom_client" class="form-label">Prénom du client</label>
        <input type="text" class="form-control" id="prenom_client" name="prenom_client" required>
      </div>
      <div class="mb-3">
        <label for="telephone_client" class="form-label">Téléphone</label>
        <input type="tel" class="form-control" id="telephone_client" name="telephone_client" required>
      </div>
      <div class="mb-3">
        <label for="enseigne" class="form-label">Enseigne</label>
        <input type="text" class="form-control" id="enseigne" name="enseigne" required>
      </div>
      <div class="mb-3">
        <label for="adresse_remplacement" class="form-label">Adresse du lieu de remplacement</label>
        <input type="text" class="form-control" id="adresse_remplacement" name="adresse_remplacement" required>
      </div>
      <div class="mb-3">
        <label for="societe_a_facturer" class="form-label">Nom de la société à facturer</label>
        <input type="text" class="form-control" id="societe_a_facturer" name="societe_a_facturer" required>
      </div>
      <div class="mb-3">
        <label for="adresse_facturation" class="form-label">Adresse de facturation</label>
        <input type="text" class="form-control" id="adresse_facturation" name="adresse_facturation" required>
      </div>
      <div class="mb-3">
        <label for="numero_tva" class="form-label">Numéro de TVA intracommunautaire</label>
        <input type="text" class="form-control" id="numero_tva" name="numero_tva">
      </div>
      <div class="mb-3">
        <label for="siret" class="form-label">SIRET</label>
        <input type="text" class="form-control" id="siret" name="siret">
      </div>
      <div class="mb-3">
        <label for="date_debut" class="form-label">Date de début de réservation</label>
        <input type="date" class="form-control" id="date_debut" name="date_debut" required>
      </div>
      <div class="mb-3">
        <label for="date_fin" class="form-label">Date de fin de réservation</label>
        <input type="date" class="form-control" id="date_fin" name="date_fin" required>
      </div>
      <button type="submit" class="btn btn-primary">Envoyer</button>
    </form>
    <div id="message" class="mt-3"></div>
  </div>
  <script>
    document.getElementById('reservationForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const data = {
        nom_client: document.getElementById('nom_client').value,
        prenom_client: document.getElementById('prenom_client').value,
        telephone_client: document.getElementById('telephone_client').value,
        enseigne: document.getElementById('enseigne').value,
        adresse_remplacement: document.getElementById('adresse_remplacement').value,
        societe_a_facturer: document.getElementById('societe_a_facturer').value,
        adresse_facturation: document.getElementById('adresse_facturation').value,
        numero_tva: document.getElementById('numero_tva').value,
        siret: document.getElementById('siret').value,
        date_debut: document.getElementById('date_debut').value,
        date_fin: document.getElementById('date_fin').value
      };
      try {
        const res = await fetch('/api/reservations', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        const result = await res.json();
        if (res.ok) {
          document.getElementById('message').innerHTML = '<div class="alert alert-success">Réservation enregistrée !</div>';
          document.getElementById('reservationForm').reset();
        } else {
          document.getElementById('message').innerHTML = '<div class="alert alert-danger">Erreur : ' + (result.error || 'Erreur inconnue') + '</div>';
        }
      } catch (err) {
        document.getElementById('message').innerHTML = '<div class="alert alert-danger">Erreur lors de la requête</div>';
      }
    });
  </script>
</body>
</html>